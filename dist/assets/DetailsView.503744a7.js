import{S as l}from"./VueStarRating.common.2328365b.js";import{_,F as g,m as p,r as a,o as h,c as f,a as e,t as o,f as c,b as m,u as P}from"./index.14df926a.js";import{u as S}from"./products.2abeeee1.js";import{u as R}from"./firestore.898c49cc.js";const v={data(){return{currentProduct:{},rating:null,userRating:null}},components:{StarRating:l,Footers:g},computed:{...p(S,R,P),getUser(){return this.authenticationStore.user}},async mounted(){this.currentProduct=await this.firestoreStore.getIndiProduct(this.$route.params.productId)},methods:{formatPrice(r){let t=(r/1).toFixed(2).replace(".",",");return"$"+t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},addToCart(){this.productsStore.addProductToCart(this.getUser,this.currentProduct)},async rateProduct(){if(this.authenticationStore.getUser()!==null){let r=this.authenticationStore.getUser().uid,t=await this.firestoreStore.getUser(r);!t.rating||!t.rating.includes(this.currentProduct.id)&&this.rating!==null?(this.firestoreStore.addUserRating(r,this.userRatings(t)),this.firestoreStore.addProductRating(this.currentProduct.id,this.productRating(this.currentProduct)),this.firestoreStore.changeRating(this.currentProduct)):alert("Product already voted")}else alert("Please sign in before voting")},userRatings(r){let t;return r.rating===null||r.rating===void 0?t=[this.currentProduct.id]:r.rating.length>0&&(t=[...r.rating,this.currentProduct.id]),t},productRating(r){let t;return r.ratingList==null||r.ratingList==null?t=[this.rating]:r.ratingList.length>0&&(t=[...r.ratingList,this.rating]),t}}},y={class:"product"},C=["src"],F={class:"product__info"},U={class:"product__info__name"},k={class:"product__info__desc"},w={class:"product__info__price"};function x(r,t,b,A,i,s){const u=a("star-rating"),d=a("Footers");return h(),f(m,null,[e("div",y,[e("img",{src:i.currentProduct.image,alt:"preview",class:"product__pic"},null,8,C),e("div",F,[e("p",U,o(i.currentProduct.name),1),c(u,{class:"product__info__star",rating:i.rating,"onUpdate:rating":t[0]||(t[0]=n=>i.rating=n),"star-size":20,onClick:s.rateProduct},null,8,["rating","onClick"]),e("p",k,o(i.currentProduct.description),1),e("p",w,o(s.formatPrice(i.currentProduct.price)),1),e("button",{class:"product__info__btn",onClick:t[1]||(t[1]=(...n)=>s.addToCart&&s.addToCart(...n))},"Add to cart")])]),c(d)],64)}const D=_(v,[["render",x]]);export{D as default};
